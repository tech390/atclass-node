{"version":3,"sources":["../../../src/db/migrations/mysqlMigration_initial_table_creation.js"],"names":["exports","up","knex","Promise","tableExists","schema","hasTable","createTable","table","uuid","primary","integer","string","boolean","specificType","dateTime","defaultTo","fn","now","unique","getBaseMigration","BaseMigration","res","upsertMetaData","Log","info","resolve","down"],"mappings":";;AAAA;;AAGA;;AAIAA,QAAQC,EAAR,GAAa,eAAeA,EAAf,CAAkBC,IAAlB,EAAwBC,OAAxB,EAAiC;AAC1C,QAAIC,cAAc,MAAMF,KAAKG,MAAL,CAAYC,QAAZ,CAAqB,gBAArB,CAAxB;AACA,QAAI,CAACF,WAAL,EAAkB;AACd,cAAMF,KAAKG,MAAL,CAAYE,WAAZ,CAAwB,gBAAxB,EAA0C,iBAAS;AACrDC,kBAAMC,IAAN,CAAW,YAAX,EAAyBC,OAAzB;AACAF,kBAAMG,OAAN,CAAc,IAAd,EAAoB,GAApB;AACAH,kBAAMI,MAAN,CAAa,MAAb,EAAqB,GAArB;AACAJ,kBAAMI,MAAN,CAAa,MAAb,EAAqB,GAArB;AACAJ,kBAAMK,OAAN,CAAc,QAAd;AACAL,kBAAMM,YAAN,CAAmB,iBAAnB,EAAsC,MAAtC;AACAN,kBAAMO,QAAN,CAAe,cAAf,EAA+BC,SAA/B,CAAyCd,KAAKe,EAAL,CAAQC,GAAR,EAAzC;AACAV,kBAAMO,QAAN,CAAe,eAAf;AACAP,kBAAMO,QAAN,CAAe,cAAf;AACAP,kBAAMW,MAAN,CAAa,CAAC,IAAD,EAAO,MAAP,CAAb;AACH,SAXK,CAAN;AAYH;;AAED,QAAMC,mBAAmB,IAAIC,6BAAJ,EAAzB;AACA,QAAMC,MAAM,MAAMF,iBAAiBG,cAAjB,EAAlB;AACA,QAAID,GAAJ,EAAS;AACLE,iBAAIC,IAAJ,CAAS,kCAAT;AACH;;AAED,WAAOtB,QAAQuB,OAAR,CAAgB,IAAhB,CAAP;AACH,CAxBD;;AA0BA1B,QAAQ2B,IAAR,GAAe,SAASA,IAAT,CAAczB,IAAd,EAAoBC,OAApB,EAA6B;AACxC,WAAOA,QAAQuB,OAAR,CAAgB,IAAhB,CAAP;AACH,CAFD","file":"mysqlMigration_initial_table_creation.js","sourcesContent":["import {\r\n    BaseMigration\r\n} from './base/baseMigrations';\r\nimport {\r\n    Log\r\n} from '../../services/log';\r\n\r\nexports.up = async function up(knex, Promise) {\r\n    let tableExists = await knex.schema.hasTable('mysql_metadata');\r\n    if (!tableExists) {\r\n        await knex.schema.createTable('mysql_metadata', table => {\r\n            table.uuid('mysql_guid').primary();\r\n            table.integer('ID', 200);\r\n            table.string('Name', 200);\r\n            table.string('Role', 200);\r\n            table.boolean('HasJob');\r\n            table.specificType('PersonalDetails', 'JSON');\r\n            table.dateTime('created_date').defaultTo(knex.fn.now());\r\n            table.dateTime('modified_date');\r\n            table.dateTime('deleted_date');\r\n            table.unique(['ID', 'Name']);\r\n        });\r\n    }\r\n\r\n    const getBaseMigration = new BaseMigration();\r\n    const res = await getBaseMigration.upsertMetaData();\r\n    if (res) {\r\n        Log.info('migration done and data inserted');\r\n    }\r\n\r\n    return Promise.resolve(true);\r\n};\r\n\r\nexports.down = function down(knex, Promise) {\r\n    return Promise.resolve(true);\r\n};\r\n"]}