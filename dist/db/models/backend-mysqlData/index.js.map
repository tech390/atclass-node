{"version":3,"sources":["../../../../src/db/models/backend-mysqlData/index.js"],"names":["backendmysqlData","Bookshelf","Model","extend","tableName","idAttribute","uuid","hasTimestamps","jsonColumns","upsert","upsertData","Error","existingModel","query","where","ID","Name","fetch","set","save","method"],"mappings":";;;;;;AAAA;;;;;;AAEA,IAAMA,mBAAmBC,oBAAUC,KAAV,CAAgBC,MAAhB,CAAuB;AAC5CC,eAAW,gBADiC;AAE5CC,iBAAa,YAF+B;AAG5CC,UAAM,IAHsC;AAI5CC,mBAAe,CAAC,cAAD;AAJ6B,CAAvB,EAKtB;AACCC,iBAAa,CAAC,iBAAD,CADd;AAEOC,UAFP,wBAEcC,UAFd,EAE0B;AACrB,YAAI,CAACA,UAAL,EAAiB;AACb,kBAAM,IAAIC,KAAJ,CAAU,uBAAV,CAAN;AACH;AACD,YAAMC,gBAAgB,MAAM,KAAKC,KAAL,CAAW;AACnCC,mBAAO;AACHC,oBAAIL,WAAWK,EADZ;AAEHC,sBAAMN,WAAWM;AAFd;AAD4B,SAAX,EAKzBC,KALyB,EAA5B;AAMA,YAAIL,aAAJ,EAAmB;AACf,kBAAMA,cAAcM,GAAd,CAAkBR,UAAlB,EAA8BS,IAA9B,CAAmC,IAAnC,EAAyC,EAAEC,QAAQ,QAAV,EAAzC,CAAN;AACH,SAFD,MAEO;AACH,kBAAM,IAAI,IAAJ,CAASV,UAAT,EAAqBS,IAArB,CAA0B,EAA1B,EAA8B,EAAEC,QAAQ,QAAV,EAA9B,CAAN;AACH;AACD,eAAO,IAAP;AACH;AAlBF,CALsB,CAAzB;;kBA0BepB,gB","file":"index.js","sourcesContent":["import Bookshelf from '../../bookshelf.config';\r\n\r\nconst backendmysqlData = Bookshelf.Model.extend({\r\n    tableName: 'mysql_metadata',\r\n    idAttribute: 'mysql_guid',\r\n    uuid: true,\r\n    hasTimestamps: ['created_date']\r\n}, {\r\n    jsonColumns: ['PersonalDetails'],\r\n    async upsert(upsertData) {\r\n        if (!upsertData) {\r\n            throw new Error('Invalid upsert object');\r\n        }\r\n        const existingModel = await this.query({\r\n            where: {\r\n                ID: upsertData.ID,\r\n                Name: upsertData.Name\r\n            }\r\n        }).fetch();\r\n        if (existingModel) {\r\n            await existingModel.set(upsertData).save(null, { method: 'update' });\r\n        } else {\r\n            await new this(upsertData).save({}, { method: 'insert' });\r\n        }\r\n        return true;\r\n    }\r\n});\r\n\r\nexport default backendmysqlData;\r\n"]}